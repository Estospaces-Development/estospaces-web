import{r as n,n as T,j as e,F as y,C as p,k as D}from"./index-D9fuy-ar.js";import{g as A,s as E}from"./contractsService-cBdU8hYz.js";import{R as P}from"./refresh-cw-D3D2tFTT.js";import{C as f}from"./clock-D-pnzsNv.js";import{E as F}from"./eye-Dzbd2rxv.js";import{P as j}from"./pen-tool-CAHPFWF0.js";const m={draft:{label:"Draft",color:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",icon:e.jsx(y,{size:14})},pending_user_signature:{label:"Awaiting Tenant",color:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400",icon:e.jsx(f,{size:14})},pending_manager_signature:{label:"Awaiting Your Signature",color:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400",icon:e.jsx(j,{size:14})},active:{label:"Active",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",icon:e.jsx(p,{size:14})},terminated:{label:"Terminated",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",icon:e.jsx(D,{size:14})}};function I(){const[d,k]=n.useState([]),[g,N]=n.useState(!0),[x,_]=n.useState(null),[a,i]=n.useState(null),[o,C]=n.useState("all"),{success:S,error:h}=T(),b=n.useCallback(async()=>{N(!0);const{data:t,error:r}=await A();r?h(r):t&&k(t),N(!1)},[h]);n.useEffect(()=>{b()},[b]);const v=async t=>{_(t);const{data:r,error:l}=await E(t,"manager");l?h(l):r&&(S("Contract countersigned successfully!"),k($=>$.map(w=>w.id===t?r:w)),(a==null?void 0:a.id)===t&&i(r)),_(null)},u=d.filter(t=>o==="all"?!0:o==="pending"?t.status==="pending_user_signature"||t.status==="pending_manager_signature":t.status===o),z=[{key:"all",label:"All",count:d.length},{key:"pending",label:"Pending",count:d.filter(t=>t.status.startsWith("pending")).length},{key:"active",label:"Active",count:d.filter(t=>t.status==="active").length},{key:"draft",label:"Drafts",count:d.filter(t=>t.status==="draft").length}],s=t=>t?new Date(t).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"—",c=t=>t!=null?`£${t.toLocaleString("en-GB",{minimumFractionDigits:2})}`:"—";return e.jsxs("div",{className:"p-6 md:p-8 font-outfit",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(y,{className:"text-orange-500"})," Contracts"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Manage tenancy agreements and digital signatures"})]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-sm font-medium text-gray-700 dark:text-gray-300 transition-colors",children:[e.jsx(P,{size:16,className:g?"animate-spin":""})," Refresh"]})]}),e.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:z.map(t=>e.jsxs("button",{onClick:()=>C(t.key),className:`px-4 py-2 rounded-xl text-sm font-medium whitespace-nowrap transition-all ${o===t.key?"bg-orange-500 text-white shadow-md":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[t.label," ",e.jsxs("span",{className:"ml-1 opacity-70",children:["(",t.count,")"]})]},t.key))}),g&&e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"w-8 h-8 border-3 border-orange-500 border-t-transparent rounded-full animate-spin"})}),!g&&u.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(y,{className:"mx-auto text-gray-300 dark:text-gray-600 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 dark:text-gray-400",children:"No contracts found"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:"Contracts are created from approved applications."})]}),!g&&u.length>0&&e.jsx("div",{className:"grid gap-4",children:u.map(t=>{const r=m[t.status]||m.draft,l=t.status==="pending_manager_signature";return e.jsx("div",{className:`bg-white dark:bg-gray-800 rounded-2xl p-5 shadow-sm hover:shadow-md transition-shadow ${l?"ring-2 ring-orange-400/50":""}`,children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${r.color}`,children:[r.icon," ",r.label]}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:t.contract_type==="rental"?"Tenancy Agreement":t.contract_type})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"Rent"}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[c(t.monthly_rent),"/mo"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"Deposit"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:c(t.deposit_amount)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"Start"}),e.jsx("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:s(t.start_date)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs",children:"End"}),e.jsx("p",{className:"font-medium text-gray-700 dark:text-gray-300",children:s(t.end_date)})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-xs",children:[e.jsxs("span",{className:`flex items-center gap-1 ${t.user_signed_at?"text-green-600 dark:text-green-400":"text-gray-400 dark:text-gray-500"}`,children:[t.user_signed_at?e.jsx(p,{size:12}):e.jsx(f,{size:12}),"Tenant ",t.user_signed_at?`signed ${s(t.user_signed_at)}`:"not signed"]}),e.jsxs("span",{className:`flex items-center gap-1 ${t.manager_signed_at?"text-green-600 dark:text-green-400":"text-gray-400 dark:text-gray-500"}`,children:[t.manager_signed_at?e.jsx(p,{size:12}):e.jsx(f,{size:12}),"You ",t.manager_signed_at?`signed ${s(t.manager_signed_at)}`:"not signed"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsxs("button",{onClick:()=>i(t),className:"flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(F,{size:16})," View"]}),l&&e.jsx("button",{onClick:()=>v(t.id),disabled:x===t.id,className:"flex items-center gap-1.5 px-4 py-2 rounded-xl text-sm font-medium bg-orange-500 hover:bg-orange-600 text-white shadow-sm transition-colors disabled:opacity-70",children:x===t.id?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Signing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{size:16})," Countersign"]})})]})]})},t.id)})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",onClick:()=>i(null),children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl w-full max-w-2xl shadow-2xl max-h-[85vh] flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(y,{className:"text-orange-500"})," Contract Details"]}),e.jsx("button",{onClick:()=>i(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors text-gray-500",children:"✕"})]}),e.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar space-y-4",children:[(()=>{const t=m[a.status]||m.draft;return e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${t.color}`,children:[t.icon," ",t.label]})})(),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Monthly Rent"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:c(a.monthly_rent)})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Security Deposit"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white",children:c(a.deposit_amount)})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Start Date"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s(a.start_date)})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"End Date"}),e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s(a.end_date)})]})]}),a.terms_and_conditions&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Terms & Conditions"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 text-sm text-gray-600 dark:text-gray-400 whitespace-pre-wrap",children:a.terms_and_conditions})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`rounded-xl p-4 border ${a.user_signed_at?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700"}`,children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Tenant Signature"}),e.jsx("p",{className:`font-semibold text-sm ${a.user_signed_at?"text-green-700 dark:text-green-400":"text-gray-400"}`,children:a.user_signed_at?`Signed ${s(a.user_signed_at)}`:"Pending"})]}),e.jsxs("div",{className:`rounded-xl p-4 border ${a.manager_signed_at?"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700"}`,children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Your Signature"}),e.jsx("p",{className:`font-semibold text-sm ${a.manager_signed_at?"text-green-700 dark:text-green-400":"text-gray-400"}`,children:a.manager_signed_at?`Signed ${s(a.manager_signed_at)}`:"Pending"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3 bg-gray-50 dark:bg-gray-800/50 rounded-b-2xl",children:[e.jsx("button",{onClick:()=>i(null),className:"px-5 py-2.5 border border-gray-300 dark:border-gray-600 rounded-xl text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:"Close"}),a.status==="pending_manager_signature"&&e.jsx("button",{onClick:()=>v(a.id),disabled:x===a.id,className:"px-5 py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-xl font-medium shadow-sm transition-colors disabled:opacity-70 flex items-center gap-2",children:x===a.id?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Signing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{size:16})," Countersign"]})})]})]})})]})}export{I as default};
//# sourceMappingURL=page-DcLoxAg6.js.map
