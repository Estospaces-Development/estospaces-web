import{j as e,X as O,a9 as H,u as Q,r as i,Y as W,h as X,aa as Y,V as K,q as Z,$ as P,C as I,a as ee}from"./index-DOVRzmjE.js";import{M as ae,S as se}from"./ShareModal-BAkFEMWG.js";import{E as te}from"./eye-ZHS1zas0.js";import{B as re,a as le,M as ie}from"./maximize-D4Ezb_UP.js";import{S as ne}from"./share-2-GnVVRYdw.js";import"./twitter-CrDG5WBu.js";import"./message-circle-CgMyiF1G.js";const oe=({property:a,onClose:c})=>{const n=(a==null?void 0:a.virtual_tour_url)||"https://my.matterport.com/show/?m=JGPnGQ6wM5l&play=1";return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fadeIn",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl w-full max-w-5xl h-[80vh] flex flex-col overflow-hidden shadow-2xl relative",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-800 flex items-center justify-between bg-white dark:bg-gray-900",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"3D Virtual Tour"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a==null?void 0:a.title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>window.open(n,"_blank"),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors hidden sm:block",title:"Open in new tab",children:e.jsx(ae,{size:20,className:"text-gray-600 dark:text-gray-300"})}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors",children:e.jsx(O,{size:24,className:"text-gray-600 dark:text-gray-300"})})]})]}),e.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-black relative group",children:[e.jsx("iframe",{src:n,className:"w-full h-full border-0",allow:"fullscreen",title:`Virtual Tour of ${a==null?void 0:a.title}`,loading:"lazy"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 p-4 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:e.jsx("p",{className:"text-white text-center text-sm font-medium",children:"Click and drag to look around • Use arrow keys to move"})})]})]})})},de=({property:a,onViewDetails:c,onClick:n})=>{var k,p,S,C;const T=Q(),[u,m]=i.useState(0),[M,b]=i.useState(!1),[_,f]=i.useState(!1),[v,w]=i.useState(!1),[o,j]=i.useState(""),[$,d]=i.useState(!1),{toggleProperty:F,isPropertySaved:A}=W(),{user:ce}=X(),{allApplications:L}=Y(),h=A(a.id),x=L.find(s=>s.propertyId===a.id),V=!!x||a.is_applied||!1,B=(x==null?void 0:x.status)||a.application_status||null,y=a.view_count||0,N=s=>{s==null||s.stopPropagation(),n?n():c?c(a):T(`/user/dashboard/property/${a.id}`)},D=async s=>{s.stopPropagation(),s.preventDefault();const t=h;w(!0);try{await F(a),j(t?"Property removed from saved":"Property saved successfully!"),d(!0),setTimeout(()=>d(!1),3e3)}catch(r){console.error("Error saving property:",r),j("Failed to save property"),d(!0),setTimeout(()=>d(!1),3e3)}finally{w(!1)}},l=(()=>{const s=a.images||a.image_urls;if(s&&Array.isArray(s)&&s.length>0)return s.slice(0,4);if(typeof a.images=="string"){try{const r=JSON.parse(a.images);if(Array.isArray(r))return r.slice(0,4)}catch{}if(a.images.startsWith("http"))return[a.images]}const t=a.image||a.image_url||a.thumbnail_url||a.photo||a.main_image;return t?[t]:[]})(),E=l.length>1,R=s=>{s.stopPropagation(),m(t=>(t+1)%l.length)},U=s=>{s.stopPropagation(),m(t=>(t-1+l.length)%l.length)},G=s=>{var t,r;if(typeof s=="object"&&s!==null&&"amount"in s){const{amount:g,currency:J}=s,z=new Intl.NumberFormat("en-US",{style:"currency",currency:J||"USD",maximumFractionDigits:0}).format(g);return a.property_type==="rent"||a.listingType==="rent"||((t=a.type)==null?void 0:t.toLowerCase())==="rent"?`${z}/month`:z}if(typeof s=="number"){const g=`£${s.toLocaleString("en-GB")}`;return a.property_type==="rent"||((r=a.type)==null?void 0:r.toLowerCase())==="rent"?`${g}/month`:g}return s},q=()=>$?e.jsx("div",{className:"fixed bottom-8 left-1/2 z-[99999] pointer-events-auto transform -translate-x-1/2",children:e.jsxs("div",{className:`flex items-center gap-3 px-6 py-4 rounded-2xl shadow-2xl ${o.includes("removed")||o.includes("Failed")?"bg-gray-900 text-white":"bg-green-500 text-white"}`,children:[o.includes("removed")?e.jsx(P,{size:24,className:"text-white flex-shrink-0"}):o.includes("Failed")?e.jsx("span",{className:"text-xl",children:"⚠️"}):e.jsx(I,{size:24,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"font-bold text-base whitespace-nowrap",children:o}),e.jsx("button",{onClick:s=>{s.stopPropagation(),d(!1)},className:"ml-3 text-white/80 hover:text-white transition-colors text-xl font-bold",children:"×"})]})}):null;return e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsxs("div",{onClick:N,className:"bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-sm border border-gray-100 dark:border-gray-800 hover:shadow-2xl hover:shadow-gray-200/50 dark:hover:shadow-gray-900/50 hover:-translate-y-1.5 hover:border-orange-200 dark:hover:border-orange-500/30 transition-all duration-300 group cursor-pointer h-full flex flex-col",children:[e.jsxs("div",{className:"relative h-56 bg-gray-100 dark:bg-gray-800 overflow-hidden flex-shrink-0",children:[l.length>0?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:l[u],alt:a.title,className:"object-cover group-hover:scale-105 transition-transform duration-500",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),E&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:U,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-md",children:e.jsx(K,{size:16,className:"text-gray-700"})}),e.jsx("button",{onClick:R,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-md",children:e.jsx(Z,{size:16,className:"text-gray-700"})}),e.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1.5",children:l.map((s,t)=>e.jsx("button",{onClick:r=>{r.stopPropagation(),m(t)},className:`h-1.5 rounded-full transition-all ${t===u?"bg-white w-4":"bg-white/50 w-1.5 hover:bg-white/75"}`},t))})]})]}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 font-medium",children:"No Image"})}),a.type&&e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:`px-3 py-1.5 rounded-lg text-xs font-bold shadow-sm ${((k=a.type)==null?void 0:k.toLowerCase())==="rent"?"bg-blue-500 text-white":((p=a.type)==null?void 0:p.toLowerCase())==="sale"?"bg-emerald-500 text-white":"bg-white/95 backdrop-blur-sm text-gray-800"}`,children:a.type==="Sale"?"For Sale":a.type==="Rent"?"For Rent":a.type})}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-2",children:[e.jsx("button",{onClick:D,disabled:v,className:`p-2 rounded-full backdrop-blur-sm transition-all ${h?"bg-red-500 text-white":"bg-white/90 dark:bg-white/90 text-gray-700 dark:text-gray-800 hover:bg-white dark:hover:bg-white"} ${v?"opacity-50 cursor-not-allowed":""}`,children:e.jsx(P,{size:16,className:h?"-current":""})}),V&&e.jsx("button",{className:"p-2 rounded-full backdrop-blur-sm bg-green-500 text-white",title:`Applied - ${B}`,children:e.jsx(I,{size:16,className:"-current"})}),y>0&&e.jsxs("div",{className:"p-2 rounded-full backdrop-blur-sm bg-blue-500 text-white flex items-center gap-1",children:[e.jsx(te,{size:14}),e.jsx("span",{className:"text-xs font-medium",children:y})]})]}),e.jsx("div",{className:"absolute bottom-3 left-3",children:e.jsx("span",{className:"bg-white/95 backdrop-blur-sm text-gray-900 px-3 py-1.5 rounded-md font-bold text-lg",children:G(a.price)})})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white mb-1 line-clamp-1",children:a.title}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3 flex items-center gap-1",children:[e.jsx(ee,{size:14,className:"text-gray-400 dark:text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:typeof a.location=="string"?a.location:a.address||((S=a.location)==null?void 0:S.addressLine1)||((C=a.location)==null?void 0:C.city)||"Location unavailable"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400 mb-3",children:[a.beds&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(re,{size:16,className:"text-gray-400 dark:text-gray-500"}),e.jsxs("span",{children:[a.beds," Bed",a.beds>1?"s":""]})]}),a.baths&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{size:16,className:"text-gray-400 dark:text-gray-500"}),e.jsxs("span",{children:[a.baths," Bath",a.baths>1?"s":""]})]}),a.area&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{size:16,className:"text-gray-400 dark:text-gray-500"}),e.jsxs("span",{children:[a.area," sqft"]})]})]}),e.jsxs("div",{className:"mt-auto pt-4 flex gap-2",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),b(!0)},className:"px-3 py-2 border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl text-xs font-medium transition-all",children:"Virtual Tour"}),e.jsx("button",{onClick:s=>{s.stopPropagation(),f(!0)},className:"p-2 border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-400 rounded-xl transition-all",children:e.jsx(ne,{size:16})}),e.jsx("button",{onClick:N,className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-xl font-medium text-xs transition-all shadow-sm",children:"View Details"})]})]})]}),M&&e.jsx(oe,{property:a,onClose:()=>b(!1)}),_&&e.jsx(se,{property:a,onClose:()=>f(!1)})]})},we=H.memo(de);export{we as default};
//# sourceMappingURL=PropertyCard-Dz_FikwH.js.map
