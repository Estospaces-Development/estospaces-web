{"version":3,"file":"analyticsService-DSIngNu1.js","sources":["../../src/services/analyticsService.ts"],"sourcesContent":["/**\r\n * Analytics Service\r\n * Fetches analytics data from core-service backend\r\n */\r\n\r\nimport { apiFetch, getServiceUrl, getAuthHeaders } from '@/lib/apiUtils';\r\n\r\nconst CORE_URL = () => getServiceUrl('core');\r\n\r\nexport interface PropertyPerformance {\r\n    property: string;\r\n    views: number;\r\n    applications: number;\r\n    conversionRate: number;\r\n}\r\n\r\nexport interface ApplicationByProperty {\r\n    label: string;\r\n    value: number;\r\n}\r\n\r\nexport interface TrendData {\r\n    label: string;\r\n    value: number;\r\n}\r\n\r\nexport interface LeadAnalytics {\r\n    totalLeads: number;\r\n    totalProperties: number;\r\n    conversionRate: number;\r\n    passed: number;\r\n}\r\n\r\nexport interface AnalyticsData {\r\n    propertyPerformance: PropertyPerformance[];\r\n    applicationsByProperty: ApplicationByProperty[];\r\n    revenueTrend: TrendData[];\r\n    monthlyApplicationsTrend: TrendData[];\r\n    leadAnalytics: LeadAnalytics;\r\n}\r\n\r\nexport interface AnalyticsResponse {\r\n    data: AnalyticsData | null;\r\n    error: string | null;\r\n}\r\n\r\nexport interface ManagerAnalytics {\r\n    total_leads: number;\r\n    active_leads: number;\r\n    sla_success_rate: number;\r\n    avg_response_time: number;\r\n}\r\n\r\nexport interface ManagerAnalyticsResponse {\r\n    data: ManagerAnalytics | null;\r\n    error: string | null;\r\n}\r\n\r\n/**\r\n * Fetch analytics data from the core-service backend (Admin Platform Stats)\r\n * GET /api/v1/admin/analytics (requires admin role)\r\n */\r\nexport const getPlatformAnalytics = async (): Promise<AnalyticsResponse> => {\r\n    try {\r\n        const data = await apiFetch<AnalyticsData>(\r\n            `${CORE_URL()}/api/v1/admin/analytics`,\r\n        );\r\n        return { data, error: null };\r\n    } catch (error: any) {\r\n        console.error('[analyticsService] Error:', error.message);\r\n        return { data: null, error: error.message };\r\n    }\r\n};\r\n\r\n// Deprecated alias for backward compatibility\r\nexport const getAnalyticsData = getPlatformAnalytics;\r\n\r\n/**\r\n * Fetch analytics data for the current manager\r\n * GET /api/v1/manager/analytics (requires manager/admin role)\r\n */\r\nexport const getManagerAnalytics = async (): Promise<ManagerAnalyticsResponse> => {\r\n    try {\r\n        const data = await apiFetch<ManagerAnalytics>(\r\n            `${CORE_URL()}/api/v1/manager/analytics`,\r\n        );\r\n        return { data, error: null };\r\n    } catch (error: any) {\r\n        console.error('[analyticsService] Error:', error.message);\r\n        return { data: null, error: error.message };\r\n    }\r\n};\r\n\r\n"],"names":["CORE_URL","getServiceUrl","getPlatformAnalytics","apiFetch","error","getAnalyticsData"],"mappings":"iDAOA,MAAMA,EAAW,IAAMC,EAAc,MAAM,EAuD9BC,EAAuB,SAAwC,CACxE,GAAI,CAIA,MAAO,CAAE,KAHI,MAAMC,EACf,GAAGH,GAAU,yBAAA,EAEF,MAAO,IAAA,CAC1B,OAASI,EAAY,CACjB,eAAQ,MAAM,4BAA6BA,EAAM,OAAO,EACjD,CAAE,KAAM,KAAM,MAAOA,EAAM,OAAA,CACtC,CACJ,EAGaC,EAAmBH"}