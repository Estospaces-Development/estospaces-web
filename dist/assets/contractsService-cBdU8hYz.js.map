{"version":3,"file":"contractsService-cBdU8hYz.js","sources":["../../src/services/contractsService.ts"],"sourcesContent":["import { apiFetch, getServiceUrl } from '@/lib/apiUtils';\r\n\r\nconst BOOKING_URL = () => getServiceUrl('booking');\r\n\r\nexport interface Contract {\r\n    id: string;\r\n    property_id: string;\r\n    user_id: string;\r\n    manager_id: string;\r\n    contract_type: string;\r\n    start_date: string;\r\n    end_date?: string;\r\n    monthly_rent?: number;\r\n    deposit_amount?: number;\r\n    terms_and_conditions?: string;\r\n    contract_pdf_url?: string;\r\n    status: 'draft' | 'pending_user_signature' | 'pending_manager_signature' | 'active' | 'terminated';\r\n    user_signed_at?: string;\r\n    manager_signed_at?: string;\r\n    created_at: string;\r\n    updated_at: string;\r\n}\r\n\r\nexport interface CreateContractRequest {\r\n    application_id: string;\r\n    start_date: string; // YYYY-MM-DD\r\n    end_date?: string; // YYYY-MM-DD\r\n    monthly_rent: number;\r\n    deposit_amount: number;\r\n    terms_and_conditions?: string;\r\n}\r\n\r\nexport interface SignContractRequest {\r\n    signer_role: 'user' | 'manager';\r\n}\r\n\r\nexport const createContract = async (data: CreateContractRequest): Promise<{ data: Contract | null; error: string | null }> => {\r\n    try {\r\n        const response = await apiFetch<Contract>(`${BOOKING_URL()}/api/v1/contracts`, {\r\n            method: 'POST',\r\n            body: JSON.stringify(data),\r\n        });\r\n        return { data: response, error: null };\r\n    } catch (error: any) {\r\n        return { data: null, error: error.message || 'Failed to create contract' };\r\n    }\r\n};\r\n\r\nexport const getContract = async (id: string): Promise<{ data: Contract | null; error: string | null }> => {\r\n    try {\r\n        const response = await apiFetch<Contract>(`${BOOKING_URL()}/api/v1/contracts/${id}`);\r\n        return { data: response, error: null };\r\n    } catch (error: any) {\r\n        return { data: null, error: error.message || 'Failed to fetch contract' };\r\n    }\r\n};\r\n\r\nexport const getUserContracts = async (): Promise<{ data: Contract[] | null; error: string | null }> => {\r\n    try {\r\n        const response = await apiFetch<{ data: Contract[] }>(`${BOOKING_URL()}/api/v1/contracts/mine`);\r\n        return { data: response.data, error: null };\r\n    } catch (error: any) {\r\n        return { data: null, error: error.message || 'Failed to fetch contracts' };\r\n    }\r\n};\r\n\r\nexport const signContract = async (id: string, role: 'user' | 'manager'): Promise<{ data: Contract | null; error: string | null }> => {\r\n    try {\r\n        const payload: SignContractRequest = { signer_role: role };\r\n        const response = await apiFetch<{ message: string; contract: Contract }>(`${BOOKING_URL()}/api/v1/contracts/${id}/sign`, {\r\n            method: 'PUT',\r\n            body: JSON.stringify(payload),\r\n        });\r\n        return { data: response.contract, error: null };\r\n    } catch (error: any) {\r\n        return { data: null, error: error.message || 'Failed to sign contract' };\r\n    }\r\n};\r\n"],"names":["BOOKING_URL","getServiceUrl","createContract","data","apiFetch","error","getUserContracts","signContract","id","role","payload"],"mappings":"iDAEA,MAAMA,EAAc,IAAMC,EAAc,SAAS,EAkCpCC,EAAiB,MAAOC,GAA0F,CAC3H,GAAI,CAKA,MAAO,CAAE,KAJQ,MAAMC,EAAmB,GAAGJ,EAAA,CAAa,oBAAqB,CAC3E,OAAQ,OACR,KAAM,KAAK,UAAUG,CAAI,CAAA,CAC5B,EACwB,MAAO,IAAA,CACpC,OAASE,EAAY,CACjB,MAAO,CAAE,KAAM,KAAM,MAAOA,EAAM,SAAW,2BAAA,CACjD,CACJ,EAWaC,EAAmB,SAAwE,CACpG,GAAI,CAEA,MAAO,CAAE,MADQ,MAAMF,EAA+B,GAAGJ,EAAA,CAAa,wBAAwB,GACtE,KAAM,MAAO,IAAA,CACzC,OAASK,EAAY,CACjB,MAAO,CAAE,KAAM,KAAM,MAAOA,EAAM,SAAW,2BAAA,CACjD,CACJ,EAEaE,EAAe,MAAOC,EAAYC,IAAuF,CAClI,GAAI,CACA,MAAMC,EAA+B,CAAE,YAAaD,CAAA,EAKpD,MAAO,CAAE,MAJQ,MAAML,EAAkD,GAAGJ,GAAa,qBAAqBQ,CAAE,QAAS,CACrH,OAAQ,MACR,KAAM,KAAK,UAAUE,CAAO,CAAA,CAC/B,GACuB,SAAU,MAAO,IAAA,CAC7C,OAASL,EAAY,CACjB,MAAO,CAAE,KAAM,KAAM,MAAOA,EAAM,SAAW,yBAAA,CACjD,CACJ"}