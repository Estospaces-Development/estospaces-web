{"version":3,"file":"applicationsService-CXOy1XaX.js","sources":["../../src/services/applicationsService.ts"],"sourcesContent":["/**\r\n * Applications Service\r\n * Fetches rental/sale application data from the booking-service backend\r\n */\r\n\r\nimport { apiFetch, getServiceUrl } from '@/lib/apiUtils';\r\n\r\nconst BOOKING_URL = () => getServiceUrl('booking');\r\n\r\nexport interface Application {\r\n    id: string;\r\n    property_id: string;\r\n    user_id: string;\r\n    move_in_date: string;\r\n    lease_duration_months?: number;\r\n    employment_status?: string;\r\n    employer_name?: string;\r\n    annual_income?: number;\r\n    current_address?: string;\r\n    reason_for_moving?: string;\r\n    references?: string;\r\n    document_urls?: string;\r\n    status: 'submitted' | 'approved' | 'rejected' | 'withdrawn';\r\n    reviewed_by?: string;\r\n    reviewed_at?: string;\r\n    review_notes?: string;\r\n    created_at: string;\r\n    updated_at: string;\r\n    // UI-mapped fields (populated from join or client-side)\r\n    name?: string;\r\n    email?: string;\r\n    phone?: string;\r\n    propertyInterested?: string;\r\n    score?: number;\r\n    budget?: string;\r\n    submittedDate?: string;\r\n    lastContact?: string;\r\n}\r\n\r\nexport interface ApplicationsResponse {\r\n    data: Application[] | null;\r\n    error: string | null;\r\n}\r\n\r\nexport interface ApplicationResponse {\r\n    data: Application | null;\r\n    error: string | null;\r\n}\r\n\r\n/**\r\n * Fetch applications for the logged-in user\r\n * GET /api/v1/applications (booking-service)\r\n */\r\nexport const getApplications = async (): Promise<ApplicationsResponse> => {\r\n    try {\r\n        const data = await apiFetch<Application[]>(\r\n            `${BOOKING_URL()}/api/v1/applications`,\r\n        );\r\n        return { data, error: null };\r\n    } catch (error: any) {\r\n        console.error('[applicationsService] Error:', error.message);\r\n        return { data: null, error: error.message };\r\n    }\r\n};\r\n\r\n/**\r\n * Fetch a single application by ID\r\n * GET /api/v1/applications/:id (booking-service)\r\n */\r\nexport const getApplicationById = async (applicationId: string): Promise<ApplicationResponse> => {\r\n    try {\r\n        const data = await apiFetch<Application>(\r\n            `${BOOKING_URL()}/api/v1/applications/${applicationId}`,\r\n        );\r\n        return { data, error: null };\r\n    } catch (error: any) {\r\n        console.error('[applicationsService] Error:', error.message);\r\n        return { data: null, error: error.message };\r\n    }\r\n};\r\n\r\n/**\r\n * Create a new application\r\n * POST /api/v1/applications (booking-service)\r\n */\r\nexport const createApplication = async (applicationData: {\r\n    property_id: string;\r\n    move_in_date: string;\r\n    lease_duration_months?: number;\r\n    employment_status?: string;\r\n    employer_name?: string;\r\n    annual_income?: number;\r\n    current_address?: string;\r\n    reason_for_moving?: string;\r\n}): Promise<ApplicationResponse> => {\r\n    try {\r\n        const data = await apiFetch<Application>(\r\n            `${BOOKING_URL()}/api/v1/applications`,\r\n            {\r\n                method: 'POST',\r\n                body: JSON.stringify(applicationData),\r\n            },\r\n        );\r\n        return { data, error: null };\r\n    } catch (error: any) {\r\n        console.error('[applicationsService] Error:', error.message);\r\n        return { data: null, error: error.message };\r\n    }\r\n};\r\n\r\n/**\r\n * Review an application (approve/reject)\r\n * PUT /api/v1/applications/:id/review (booking-service)\r\n */\r\nexport const reviewApplication = async (\r\n    applicationId: string,\r\n    status: 'approved' | 'rejected',\r\n    reviewNotes?: string,\r\n): Promise<ApplicationResponse> => {\r\n    try {\r\n        const data = await apiFetch<Application>(\r\n            `${BOOKING_URL()}/api/v1/applications/${applicationId}/review`,\r\n            {\r\n                method: 'PUT',\r\n                body: JSON.stringify({ status, review_notes: reviewNotes }),\r\n            },\r\n        );\r\n        return { data, error: null };\r\n    } catch (error: any) {\r\n        console.error('[applicationsService] Error:', error.message);\r\n        return { data: null, error: error.message };\r\n    }\r\n};\r\n"],"names":["BOOKING_URL","getServiceUrl","getApplications","apiFetch","error"],"mappings":"iDAOA,MAAMA,EAAc,IAAMC,EAAc,SAAS,EA8CpCC,EAAkB,SAA2C,CACtE,GAAI,CAIA,MAAO,CAAE,KAHI,MAAMC,EACf,GAAGH,GAAa,sBAAA,EAEL,MAAO,IAAA,CAC1B,OAASI,EAAY,CACjB,eAAQ,MAAM,+BAAgCA,EAAM,OAAO,EACpD,CAAE,KAAM,KAAM,MAAOA,EAAM,OAAA,CACtC,CACJ"}